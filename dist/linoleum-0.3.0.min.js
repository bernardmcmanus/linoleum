/*! linoleum - 0.3.0 - Bernard McManus - nightly - gbf0559 - 2015-01-26 */
!function(a,b){"function"==typeof define&&define.amd?define([],b):a.Linoleum=b()}(this,function(){var a,b,c,d;!function(){var e={},f={};a=function(a,b,c){e[a]={deps:b,callback:c}},d=c=b=function(a){function c(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(d._eak_seen=e,f[a])return f[a];if(f[a]={},!e[a])throw new Error("Could not find module "+a);for(var g,h=e[a],i=h.deps,j=h.callback,k=[],l=0,m=i.length;m>l;l++)k.push("exports"===i[l]?g={}:b(c(i[l])));var n=j.apply(this,k);return f[a]=g||n}}(),a("amd-loader",function(){}),function(){function b(){var a=C.now(),c=b.last,d=.001;return c=(a===D.floor(c)?c:a)+d,b.last=c,c}function c(a){return a.length}function d(a,b){return a.indexOf(b)}function e(a){return A.isArray(a)}function f(a){return e(a)?a:a!==z?[a]:[]}function g(a,b){return f(a).forEach(b)}function h(a){return B.create(a)}function i(a,b,c){B.defineProperty(a,b,c)}function j(a,b){delete a[b]}function k(a){return B.keys(a)}function l(a){return A[E].shift.call(a)}function m(a){return A[E].pop.call(a)}function n(a,b,c){return A[E].slice.call(a,b||0,c)}function o(a){return a[c(a)-1]}function p(a,b){return typeof b==H?typeof a==b:a instanceof b}function q(a){return p(a,F)?a:function(){}}function r(a){var b={};for(var c in a)i(b,c,{value:a[c]});return b}function s(a){return(a||{})[M]?a[M]:a}function t(a,b){return a===b?null:a}function u(a){var b=this;return p(b,u)?void b.__init(b,a||{}):new u(a)}function v(a,c){var d=this;d.target=a,d.type=c,d[N]=!1,d[O]=!1,d.timeStamp=b()}function w(a,c,d){var e=this;e.func=a,e.context=c,e.uts=b(),e.bindArgs=f(d),e._reset(e)}function x(a,b){var c=a.map(function(a){return a.func});return d(c,b)}function y(){var a=h(T);return a.__init=function(a,b){for(var c in b)a[c]=b[c];U(a)},a.$watch=function(a){var b=this;return g(a,function(a){a.$when(I,b)}),b},a.$ignore=function(a){var b=this;return g(a,function(a){a.$dispel(I,!0,b)}),b},a.$$enq=function(a){var b=this;b.__stack.push(a)},a.$$flush=function(a){var b,d=this,e=d.__stack;if(!d.__inprog||a){for(d.__inprog=!0;c(e);)try{b=l(e),a||b()}catch(f){throw d.$$flush(!0),f}d.__inprog=!1}},a}var z,A=Array,B=Object,C=Date,D=Math,E="prototype",F="function",G="object",H="string",I="*",J="$when",K="$emit",L="$dispel",M="handleE$",N="cancelBubble",O="defaultPrevented",P=u,Q=v;v[E]={preventDefault:function(){this[O]=!0},stopPropagation:function(){this[N]=!0}};var R=w;w[E]={_reset:function(a){a.before=q(),a.after=q()},invoke:function(a,b){var c=this;if(!a[N]){var d=c.func,e=n(c.bindArgs).concat(f(b));e.unshift(a),c.before(a,d),d.apply(c.context,e),a[O]||c.after(a,d),c._reset(c)}}};var S=function(a){return a&&p(a,G)&&M in a},T={$once:function(){var a=this,b=a.__parse(J,arguments);return a._$when(arguments,function(c){c.before=function(c,d){a.$dispel(b[0],!0,d)}}),a.$$flush(),a},$when:function(){var a=this;return a._$when(arguments),a.$$flush(),a},$emit:function(){var a=this,b=a.__parse(K,arguments);return a.$$enq(function(){g(b[0],function(c){c!=I&&a.__invoke(c,b[1],b[2])})}),a.$$flush(),a},$dispel:function(){var a=this,b=a.__parse(L,arguments),c=s(b[2]);return a.$$enq(function(){g(b[0],function(d){a.__remove(d,c,!!b[1])})}),a.$$flush(),a},_$when:function(a,b){b=q(b);var c=this,d=c.__parse(J,a),e=s(d[2]),f=t(d[2],e);c.$$enq(function(){g(d[0],function(a){var g=c.__add(a,e,f,d[1]);b(g)})})},__parse:function(a,b){var e=this,h=[];return e.__events,b=n(b),g([0,1,2],function(g){g?2>g?(h[2]=p(o(b),F)||S(o(b))?m(b):null,h[2]=a!=L?h[2]||e:h[2]):h[1]=b[0]:(h[0]=l(b)||f(a!=J?e.__events:I),a==K&&(h[0]=1!=c(h[0])||d(h[0],I)?h[0]:e.__events))}),h},__get:function(a,b){var c=this,d=c.handlers,e=a?f(d[a]):d;return a&&b&&a!=I&&(e=c.__get(I).concat(e).sort(function(a,b){return a.uts-b.uts})),e},__invoke:function(a,b,c){var d=this,e=d.__get(a,!0),f=new Q(d,a);g(e,function(a){a.invoke(f,b)}),f[O]||q(c)(f)},__add:function(a,b,c,d){var e=this,f=new R(b,c,d),g=e.__get(a);return g.push(f),e.handlers[a]=g,f},__remove:function(a,b,d){for(var e,f=this,g=f.__get(),h=f.__get(a),i=0;i<c(h);)e=b?x(h,b):i,e>=0&&(d||a!=I)&&(h.splice(e,1),i--),i++;c(h)?g[a]=h:j(g,a)}},U=function(a){i(a,"__stack",{value:[]}),i(a,"__inprog",{value:!1,writable:!0}),i(a,"__events",{get:function(){return k(a.handlers)}}),i(a,"handlers",{value:{}}),i(a,M,{value:q(a[M]).bind(a)})},V=y(),W=function(a){var b=r(h(V));for(var c in a)b[c]=a[c];return b};P[E]=r(V),P.is=S,P.create=W,P.construct=U;var X=P;"function"==typeof a&&a.amd?a("emoney",[],function(){return X}):"object"==typeof exports?module.exports=X:this.E$=X}.call(this),a("util",[],function(){function a(a,b){return"string"==typeof b?typeof a==b:a instanceof b}function b(b){return null!==b&&!a(b,"undefined")}function c(a){return a.jquery?a.toArray():Array.isArray(a)?a:[a]}function d(a){return Array.prototype.slice.call(a,0)}function e(a,b){return a.filter(function(a){return b.indexOf(a)<0})}function f(a){return a[(a.length||1)-1]}return{is:a,notNull:b,ensureArray:c,arrayCast:d,inverse:e,last:f}}),a("asap",[],function(){function a(a,b){n[i]=a,n[i+1]=b,i+=2,2==i&&g()}function b(){var a=0,b=new l(e),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function c(){var a=new MessageChannel;return a.port1.onmessage=e,function(){a.port2.postMessage(0)}}function d(){return function(){setTimeout(e,1)}}function e(){for(var a=0;i>a;a+=2){var b=n[a],c=n[a+1];b(c),n[a]=f,n[a+1]=f}i=0}var f,g,h=""+f,i=0,j=({}.toString,typeof window!=h?window:f),k=j||{},l=k.MutationObserver||k.WebKitMutationObserver,m=(typeof process!=h&&"[object process]"=={}.toString.call(process),typeof Uint8ClampedArray!=h&&typeof importScripts!=h&&typeof MessageChannel!=h),n=new Array(1e3);return g=l?b():m?c():d(),a}),a("tile",["util"],function(a){function b(d){var f=this;f.element=d,c.forEach(function(c){var g=c.toUpperCase(),h=e._getAttr(d,e[g]);f[c]=a.notNull(h)?h:b.defaults[c]})}var c=["index","sort","sticky","included","enabled"];return Object.defineProperties(b,{defaults:{get:function(){return{sticky:!1,included:!0,enabled:!0}}}}),b.prototype={init:function(a){var b=this;return b.index=a,b.sort=a,b},write:function(a){var b=this,c=b.element;return $.extend(b,a),c.setAttribute(e.INDEX,b.index),c.setAttribute(e.SORT_INDEX,b.sort),c.setAttribute(e.STICKY,b.sticky),c.setAttribute(e.INCLUDED,b.included),c.setAttribute(e.ENABLED,b.enabled),b}},b}),a("grid",["util","tile"],function(a,b){function c(a,b){var c=this;$.extend(!0,c,b),c.rows=0,c.cols=0,c.add($(a)),Object.defineProperties(c,{count:{get:function(){return c.get().length}},last:{get:function(){return c.slice(0).sort(function(a,b){return a.index-b.index}).pop()}},marginX:{get:function(){var a=c.margin;return a.left+a.right}},marginY:{get:function(){var a=c.margin;return a.top+a.bottom}},iSize:{get:function(){var a=c.elements();return{width:$(a).outerWidth(),height:$(a).outerHeight()}}},oSize:{get:function(){var a=c.iSize;return{width:a.width+c.marginX,height:a.height+c.marginY}}},size:{get:function(){var a=c.oSize;return{width:a.width*c.cols,height:a.height*c.rows}}}})}return c.prototype=function(){var c=Object.create(Array.prototype);return c.add=function(c){var d=this,e=d.last;return a.ensureArray(c).forEach(function(a,c){d.push(new b(a).init(c+(e?e.index:0)))}),d._order()},c.remove=function(b){var c=this,d=a.ensureArray(b),e=c.get(!0).filter(function(a){return d.indexOf(a.element)<0});return c._swap(e)._order()},c._order=function(){var a=this;return a.sort(function(a,b){return a.index-b.index}).map(function(a,b){return a.write({index:b})}).sort(function(a,b){return a.sort-b.sort}).map(function(a,b){return a.write({sort:b})}),a},c.get=function(a){var c=this,d=c;return a!==!0&&(a=$.extend(b.defaults,a),d=d.filter(function(b){for(var c in a)if(a[c]!==b[c])return!1;return!0})),d.sort(function(a,b){return a.sort-b.sort})},c.elements=function(a){var b=this;return b.get(a).map(function(a){return a.element})},c._filter=function(b){{var c=this,d=c.get({sticky:!0}),e=c.filter(b),f=a.inverse(c,e);[].concat(d,e,f)}return e.forEach(function(a){a.write({included:!0})}),f.forEach(function(a){a.write({included:!1})}),c},c._sort=function(a){var b=this;return b.sort(a).forEach(function(a,b){a.write({sort:b})}),b},c._swap=function(a){var b=this;for(b.splice(0);a.length;)b.push(a.shift());return b},c.resize=function(a,b){var c=this,d=c._buildLayout(a,b);return d?(c.layout=d,!0):!1},c.distribute=function(a){var b=this,c=b.elements(),d=b.layout;return $(c).hx().detach().clear(),a.delay&&$(c).hx("defer",a.delay),$(c).hx(a.method,{type:"transform",translate:function(a,b){return d[b]},duration:a.duration,easing:a.easing})},c._buildLayout=function(a,b){var c=this,d=c._getCols(a),e=c._getRows(d),f=[];if(b||d!=c.cols||e!=c.rows){for(var g=0;e>g;g++)for(var h=0;d>h;h++)f.push({x:c._getX(h),y:c._getY(g)});c.rows=e,c.cols=d}else f=!1;return f},c._getX=function(a){var b=this,c=(b.margin,b.iSize);return(c.width+b.marginX)*a+b.marginX/2},c._getY=function(a){var b=this,c=(b.margin,b.iSize);return(c.height+b.marginY)*a+b.marginY/2},c._getCols=function(a){var b=this,c=b.count,d=b.oSize,e=a.getBoundingClientRect(),f=Math.floor(e.width/d.width);return c>=f?f:c},c._getRows=function(a){var b=this;return Math.ceil(b.count/a)||0},c}(),c}),a("linoleum",["util","asap","grid"],function(a,b,c){function d(b,d){var g=this;g.method="animate",g.duration=400,g.delay=200,g.easing="ease",g.margin=e(5),$.extend(!0,g,d),a.is(g.margin,"object")||(g.margin=e(g.margin)),g.enabled=!0,g.container=null,g.grid=new c(b,{margin:g.margin}),E$.construct(g),Object.defineProperties(g,{distroOpts:{get:function(){return{method:g.method,duration:g.duration,easing:g.easing,delay:g.delay,force:!0}}},included:{get:function(){return g.grid.elements({included:!0})}},excluded:{get:function(){return g.grid.elements({included:!1})}}}),f.forEach(function(a){window.addEventListener(a,g)})}function e(a){var b={};return["left","right","top","bottom"].forEach(function(c){b[c]=a}),b}var f=["resize","orientationchange"],g="linoleum-sizer",h="linoleum.distribute",i="linoleum.resize",j="linoleum.sort",k="linoleum.filter",l="linoleum.error",m="linoleum.add",n="linoleum.remove";return d._defineAttr=function(a){return"data-linoleum-"+a},d._getAttr=function(b,c){var e=b.getAttribute(c);switch(c){case d.INDEX:case d.SORT_INDEX:return isNaN(parseInt(e,10))?null:parseInt(e,10);case d.STICKY:case d.INCLUDED:case d.ENABLED:return a.notNull(e)?!0:null;default:return e}},d.INDEX=d._defineAttr("index"),d.SORT_INDEX=d._defineAttr("sort"),d.STICKY=d._defineAttr("sticky"),d.INCLUDED=d._defineAttr("included"),d.ENABLED=d._defineAttr("enabled"),d.prototype=E$.create({handleEvent:function(a){var b=this;switch(a.type){case"resize":case"orientationchange":b.distribute({force:!1}).then(function(a){a&&b.$emit(i,[b.grid])})}},sizer:function(){var a=this,c=a.grid;return b(function(){var b=document.createElement("div"),d=a.container;$(d).find("."+g).length||($(b).addClass(g).appendTo(d),a.$when(h,function(){$(b).css({width:c.size.width,height:c.size.height})}))}),a},distribute:function(){var c=this,d=c.grid,e=a.arrayCast(arguments),f=a.is(e[0],"string")?e.shift():null,g=e.pop();return c.container=$(f).get(0)||c.container,g=$.extend(c.distroOpts,g),new Promise(function(a){b(function(){d.resize(c.container,g.force)?c.$emit(h,[d],function(){d.distribute(g).hx("done",function(){a(!0)})}):a(!1)})}).catch(function(a){c.$emit(l,a)})},sort:function(a){var b=this,c=b.grid;return new Promise(function(d){c._sort(a||function(){return 0}),b.$emit(j,[c],d),reject()}).catch(function(a){a&&b.$emit(l,a)})},filter:function(a){var b=this,c=b.grid;return new Promise(function(d){c._filter(a||function(){return!0}),b.$emit(k,[c],d),reject()}).catch(function(a){a&&b.$emit(l,a)})},add:function(a){var b=this;b.$emit(m,[a],function(){b.grid.add(a)})},remove:function(a){var b=this;b.$emit(n,[a],function(){b.grid.remove(a)})}}),d});var e=c("linoleum");return e.Grid=c("grid"),e.Tile=c("tile"),e});