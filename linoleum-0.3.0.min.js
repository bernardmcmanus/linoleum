/*! linoleum - 0.3.0 - [object Object] - ga224cd - 2015-01-22 */
(function(){"use strict";function a(){var b=B.now(),c=a.last,d=.001;return c=(b===C.floor(c)?c:b)+d,a.last=c,c}function b(a){return a.length}function c(a,b){return a.indexOf(b)}function d(a){return z.isArray(a)}function e(a){return d(a)?a:a!==y?[a]:[]}function f(a,b){return e(a).forEach(b)}function g(a){return A.create(a)}function h(a,b,c){A.defineProperty(a,b,c)}function i(a,b){delete a[b]}function j(a){return A.keys(a)}function k(a){return z[D].shift.call(a)}function l(a){return z[D].pop.call(a)}function m(a,b,c){return z[D].slice.call(a,b||0,c)}function n(a){return a[b(a)-1]}function o(a,b){return typeof b==G?typeof a==b:a instanceof b}function p(a){return o(a,E)?a:function(){}}function q(a){var b={};for(var c in a)h(b,c,{value:a[c]});return b}function r(a){return(a||{})[L]?a[L]:a}function s(a,b){return a===b?null:a}function t(a){var b=this;return o(b,t)?void b.__init(b,a||{}):new t(a)}function u(b,c){var d=this;d.target=b,d.type=c,d[M]=!1,d[N]=!1,d.timeStamp=a()}function v(b,c,d){var f=this;f.func=b,f.context=c,f.uts=a(),f.bindArgs=e(d),f._reset(f)}function w(a,b){var d=a.map(function(a){return a.func});return c(d,b)}function x(){var a=g(S);return a.__init=function(a,b){for(var c in b)a[c]=b[c];T(a)},a.$watch=function(a){var b=this;return f(a,function(a){a.$when(H,b)}),b},a.$ignore=function(a){var b=this;return f(a,function(a){a.$dispel(H,!0,b)}),b},a.$$enq=function(a){var b=this;b.__stack.push(a)},a.$$flush=function(a){var c,d=this,e=d.__stack;if(!d.__inprog||a){for(d.__inprog=!0;b(e);)try{c=k(e),a||c()}catch(f){throw d.$$flush(!0),f}d.__inprog=!1}},a}var y,z=Array,A=Object,B=Date,C=Math,D="prototype",E="function",F="object",G="string",H="*",I="$when",J="$emit",K="$dispel",L="handleE$",M="cancelBubble",N="defaultPrevented",O=t,P=u;u[D]={preventDefault:function(){this[N]=!0},stopPropagation:function(){this[M]=!0}};var Q=v;v[D]={_reset:function(a){a.before=p(),a.after=p()},invoke:function(a,b){var c=this;if(!a[M]){var d=c.func,f=m(c.bindArgs).concat(e(b));f.unshift(a),c.before(a,d),d.apply(c.context,f),a[N]||c.after(a,d),c._reset(c)}}};var R=function(a){return a&&o(a,F)&&L in a},S={$once:function(){var a=this,b=a.__parse(I,arguments);return a._$when(arguments,function(c){c.before=function(c,d){a.$dispel(b[0],!0,d)}}),a.$$flush(),a},$when:function(){var a=this;return a._$when(arguments),a.$$flush(),a},$emit:function(){var a=this,b=a.__parse(J,arguments);return a.$$enq(function(){f(b[0],function(c){c!=H&&a.__invoke(c,b[1],b[2])})}),a.$$flush(),a},$dispel:function(){var a=this,b=a.__parse(K,arguments),c=r(b[2]);return a.$$enq(function(){f(b[0],function(d){a.__remove(d,c,!!b[1])})}),a.$$flush(),a},_$when:function(a,b){b=p(b);var c=this,d=c.__parse(I,a),e=r(d[2]),g=s(d[2],e);c.$$enq(function(){f(d[0],function(a){var f=c.__add(a,e,g,d[1]);b(f)})})},__parse:function(a,d){var g=this,h=[];return g.__events,d=m(d),f([0,1,2],function(f){f?2>f?(h[2]=o(n(d),E)||R(n(d))?l(d):null,h[2]=a!=K?h[2]||g:h[2]):h[1]=d[0]:(h[0]=k(d)||e(a!=I?g.__events:H),a==J&&(h[0]=1!=b(h[0])||c(h[0],H)?h[0]:g.__events))}),h},__get:function(a,b){var c=this,d=c.handlers,f=a?e(d[a]):d;return a&&b&&a!=H&&(f=c.__get(H).concat(f).sort(function(a,b){return a.uts-b.uts})),f},__invoke:function(a,b,c){var d=this,e=d.__get(a,!0),g=new P(d,a);f(e,function(a){a.invoke(g,b)}),g[N]||p(c)(g)},__add:function(a,b,c,d){var e=this,f=new Q(b,c,d),g=e.__get(a);return g.push(f),e.handlers[a]=g,f},__remove:function(a,c,d){for(var e,f=this,g=f.__get(),h=f.__get(a),j=0;j<b(h);)e=c?w(h,c):j,e>=0&&(d||a!=H)&&(h.splice(e,1),j--),j++;b(h)?g[a]=h:i(g,a)}},T=function(a){h(a,"__stack",{value:[]}),h(a,"__inprog",{value:!1,writable:!0}),h(a,"__events",{get:function(){return j(a.handlers)}}),h(a,"handlers",{value:{}}),h(a,L,{value:p(a[L]).bind(a)})},U=x(),V=function(a){var b=q(g(U));for(var c in a)b[c]=a[c];return b};O[D]=q(U),O.is=R,O.create=V,O.construct=T;var W=O;"function"==typeof define&&define.amd?define([],function(){return W}):"object"==typeof exports?module.exports=W:this.E$=W}).call(this),window.Linoleum=function(a,b,c,d,e,f,g){function h(b,d){var e=this;e.duration=400,e.delay=200,e.easing="ease",e.margin={left:5,right:5,top:5,bottom:5},f.extend(!0,e,d),e.enabled=!0,e.container=null,e.grid=new h.Grid(b,{margin:e.margin}),g.construct(e),c.defineProperties(e,{hxOptions:{get:function(){return{duration:e.duration,easing:e.easing,delay:e.delay}}}}),e.handleEvent=e.handleEvent.bind(e),f(a).on("resize orientationchange",e.handleEvent)}return h.defineView=function(a,b){h.Tile.defineView(a,b)},h._defineAttr=function(a){return"data-linoleum-"+a},h._getAttr=function(a,b){var c=a.getAttribute(b);switch(b){case h.INDEX:return parseInt(c,10);default:return c}},h.INDEX=h._defineAttr("index"),h.STICKY=h._defineAttr("sticky"),h.EXCLUDED=h._defineAttr("excluded"),h.DISABLED=h._defineAttr("disabled"),h.prototype=g.create({handleEvent:function(a){var b=this;switch(a.type){case"resize":case"orientationchange":b.distribute()}},distribute:function(a,c){var d=this,e=d.grid;d.container=f(a).get(0)||d.container,c=f.extend(d.hxOptions,c),e.distribute(d.container,c)&&f(e).hx("done",function(){f(b).trigger("linoleum.resize",[e])})}}),function(){var c=g.create({});return c.handleEvent=function(a){var b=this;switch(a.type){case"resize":case"orientationchange":f(b.grid).hx().detach().clear().defer(b.delay),b.distribute()}},c.distribute=function(a){var c=this,d=c.grid;c.container=f(a).get(0)||c.container,d.distribute(c.container).done(function(){f(b).trigger("linoleum.resize",[d])})},c.lSort=function(a){a=a||function(){return 0};var b=this;b.beforeSort();var c=b.getSticky(),d=b.filter(function(a){return!a.sticky}).sort(a);return c.forEach(function(a,c){var e=b.sticky[c];d.splice(e,0,a)}),f.extend(b,d),b.afterSort(),b},c.lFilter=function(a){a=a||function(){return!0};var b=this;b.beforeFilter();var c=b.getSticky(),d=b.filter(function(b){if(b.sticky)return!1;var c=a(b);return c?b.include():b.exclude(),!0});return c.forEach(function(a,c){var e=b.sticky[c];d.splice(e,0,a)}),f.extend(b,d),b.afterFilter(),b},c.getSticky=function(){return this.filter(function(a){return a.sticky})},c.getIncluded=function(){return this.filter(function(a){return a.included})},c.enable=function(){this.forEach(function(a){a.enable()}),this.enabled=!0},c.disable=function(a){this.forEach(function(b){(a||!b.active)&&b.disable()}),this.enabled=!1},c.resize=function(){f(this.container).children(".sizer").height()!==this.totalY&&(f(this.container).children(".sizer").css("height",this.totalY+"px"),f(b).trigger("linoleum.resize",{rows:this.rows,columns:this.columns}))},c.destroy=function(){f(a).off("resize orientationchange",this.handleEvent)},c}(),h}(window,document,Object,Array,Error,jQuery,E$),Linoleum.Grid=function(a,b,c){function d(b,d){var e=this;$.extend(!0,e,d),e.rows=0,e.cols=0,e.size={width:$(b).outerWidth(),height:$(b).outerHeight()},$(b).toArray().map(function(a,b){var d=a.dataset[c.INDEX];return void 0===d&&a.setAttribute(c.INDEX,b),a}).sort(function(a,b){return c._getAttr(a,c.INDEX)-c._getAttr(b,c.INDEX)}).forEach(function(a){e.push(a)}),a.defineProperties(e,{marginX:{get:function(){var a=e.margin;return a.left+a.right}},marginY:{get:function(){var a=e.margin;return a.top+a.bottom}},iSize:{get:function(){return{width:$(b).outerWidth(),height:$(b).outerWidth()}}},oSize:{get:function(){var a=e.iSize;return{width:a.width+e.marginX/2,height:a.height+e.marginY/2}}},tSize:{get:function(){var a=e.oSize;return{width:a.width*e.cols+e.marginX,height:a.height*e.rows+e.marginY}}}})}return d.prototype=function(){var c=a.create(b.prototype);return c.distribute=function(a,b){var c=this,d=c._buildLayout(a);return d?($(c).hx().detach().clear().defer(b.delay).animate({type:"transform",translate:function(a,b){return d[b]},duration:b.duration,easing:b.easing}),!0):!1},c._buildLayout=function(a){var b=this,c=(b.slice(0),b._getCols(a)),d=b._getRows(c),e=[];if(c!=b.cols&&d!=b.rows){for(var f=0;d>f;f++)for(var g=0;c>g;g++)e.push({x:b._getX(g),y:b._getY(f)});b.rows=d,b.cols=c}else e=!1;return e},c._getX=function(a){var b=this,c=(b.margin,b.iSize);return(c.width+b.marginX)*a+b.marginX/2},c._getY=function(a){var b=this,c=(b.margin,b.iSize);return(c.height+b.marginY)*a+b.marginY/2},c._getCols=function(a){var b=this,c=b.length,d=b.oSize,e=a.getBoundingClientRect(),f=Math.floor(e.width/d.width);return c>=f?f:c},c._getRows=function(a){var b=this;return Math.ceil(b.length/a)||0},c}(),d}(Object,Array,Linoleum),Linoleum.Tile=function(a,b,c,d,e,f){function g(){this.view="home",this.views={}}function h(b,c){var d=e.extend(b,this,new g,c);return a.defineProperties(d,{index:m(function(){return f._getAttr(d,f.INDEX)}),sticky:m(function(){return e(d).hasClass(d.stickyClass)}),active:m(function(){return e(d).hasClass(d.activeClass)}),included:m(function(){return!e(d).hasClass(d.excludeClass)}),enabled:m(function(){return!e(d).hasClass(d.disableClass)})}),d.bcr=i(b),d}function i(a){var b=a.getBoundingClientRect(),c={width:d(getComputedStyle(a).width,10),height:d(getComputedStyle(a).height,10),left:b.left,top:b.top};return c.right=c.left+c.width,c.bottom=c.top+c.height,c}function j(c,d,f){var g=c.views[d]||n.views[d];if(!g)return!1;f=f||{};var h=a.create(g);return n.hxViewKeys.forEach(function(a){var d=h[a];"function"==typeof d&&(d=d(c)),b.isArray(d)||(d=[d]),d.forEach(function(a){e.extend(a,f)}),h[a]=d}),h}function k(a,b,c,d){var f=a,g=a.querySelector(".inner");c.before(a),e(f).hx()[c.method](c.tile),e(g).hx()[c.method](c.inner),e([f,g]).hx().then(function(d){a.view=b,c.after(a),d()}).done(d)}function l(a){var b=this;b.method="animate",b.tile=function(){return{type:"transform"}},b.inner=function(){return{type:"transform"}},b.before=function(){},b.after=function(){},e.extend(b,a)}function m(a,b){return{get:a,set:b,configurable:!0}}var n={views:{},hxViewKeys:["tile","inner"]};return h.defineView=function(a,b){n.views[a]=new l(b)},h.prototype={defineView:function(a,b){this.views[a]=new l(b)},setView:function(a,b,d){if(this.view!==a&&this.enabled){var e=j(this,a,b);if(!e)throw new c("linoleum.tile has no view '"+a+"'.");k(this,a,e,d)}},stick:function(){e(this).addClass(this.stickyClass)},unstick:function(){e(this).removeClass(this.stickyClass)},enable:function(){e(this).removeClass(this.disableClass)},disable:function(){e(this).addClass(this.disableClass)},include:function(){e(this).removeClass(this.excludeClass)},exclude:function(){e(this).addClass(this.excludeClass)},activate:function(){e(this).addClass(this.activeClass)},deactivate:function(){e(this).removeClass(this.activeClass)}},h}(Object,Array,Error,parseInt,jQuery,Linoleum);